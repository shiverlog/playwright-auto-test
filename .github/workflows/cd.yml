# Description : cd.yml - ğŸ“Œ ë°°í¬ ì›Œí¬í”Œë¡œìš°
# Author : Shiwoo Min
# Date : 2024-03-10

name: CD - Deploy

on:
  workflow_call:

jobs:
  deploy:
    name: Deploy Application
    runs-on: ubuntu-latest

    steps:
      # ì €ì¥ì†Œ ì½”ë“œ ì²´í¬ì•„ì›ƒ (ë³´í†µ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ë‚˜ ì„¤ì • íŒŒì¼ í™•ì¸ ìš©)
      - name: Checkout repository
        uses: actions/checkout@v4

      # Docker Hub ë¡œê·¸ì¸ (ë¹„ê³µê°œ ì´ë¯¸ì§€ í‘¸ì‹œ or pullì„ ìœ„í•´ í•„ìš”)
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{ secrets.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_PASSWORD }}

      # ì„œë²„ì— ë°°í¬ (ì—¬ê¸°ì„  ì˜ˆì‹œë¡œ echoë§Œ ì‹¤í–‰ë¨)
      - name: Deploy to Remote Server
        env:
          IMAGE_NAME: my-app # ì‹¤ì œ ë°°í¬í•  ì´ë¯¸ì§€ ì´ë¦„ ì§€ì •
        run: |
          echo "Docker push ì™„ë£Œ"
          echo "Deploying image: $IMAGE_NAME"
          # ì—¬ê¸°ì— ì‹¤ì œ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‚½ì… ê°€ëŠ¥ (ì˜ˆ: SSH ì ‘ì† + docker pull + restart ë“±)
